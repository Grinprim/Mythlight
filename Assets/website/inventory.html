<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mythlight RPG | Inventory</title>
    <link rel="icon" type="image/svg+xml" href="../img/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .row td { text-align: center; padding: 8px; }
        .row { border-bottom: 1px solid #282e40; }
        table { width: 100%; }
        /* Tab Active State */
        .tab-btn.active { background-color: rgba(99, 102, 241, 0.2); border-color: #6366f1; color: white; }
    </style>
</head>

<body class="bg-custom-dark text-slate-300">

    <div id="navbar-placeholder"></div>

    <main class="pt-32 pb-20 px-6 max-w-7xl mx-auto space-y-12">

        <header class="text-center mb-12">
            <h1 class="text-5xl font-bold text-white mb-4">Inventory & Creation</h1>
            <p class="text-lg text-slate-400 max-w-2xl mx-auto">
                Browse standard issue gear, or delve into the arts of crafting and alchemy.
            </p>
        </header>

        <div class="flex flex-wrap justify-center gap-4 border-b border-slate-800 pb-8 mb-8 sticky top-24 z-30 bg-custom-dark/95 backdrop-blur-sm py-4">
            <button onclick="switchView('view-equipment')" class="tab-btn active px-6 py-2 border border-slate-700 rounded-full text-sm font-bold uppercase tracking-widest hover:bg-slate-800 transition-all">
                Equipment
            </button>
            <button onclick="switchView('view-crafting')" class="tab-btn px-6 py-2 border border-slate-700 rounded-full text-sm font-bold uppercase tracking-widest hover:bg-slate-800 transition-all">
                Crafting
            </button>
            <button onclick="switchView('view-brewing')" class="tab-btn px-6 py-2 border border-slate-700 rounded-full text-sm font-bold uppercase tracking-widest hover:bg-slate-800 transition-all">
                Brewing
            </button>
        </div>

        <div id="view-equipment" class="view-section space-y-12">
            <div class="text-center space-y-4 mb-8">
                <h2 class="text-3xl text-white font-bold">Standard Equipment</h2>
                <p class="text-slate-400">Weapons, armor, and their damage types.</p>
            </div>

            <div>
                <h3 class="text-xl text-indigo-400 font-bold mb-6 uppercase tracking-widest border-b border-slate-800 pb-2">Physical Damage Types</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="rule-card p-5 border-l-4 border-l-red-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-red-400 transition-colors">Puncture</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">This damage type is all about piercing the enemy, knives, rapiers, picks, all fall into this category.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-rose-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-rose-400 transition-colors">Slash</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">From swords to sabers, its all about slashing at your foes.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-slate-400 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-slate-300 transition-colors">Blunt</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Heavy, armor-crushing force and impact. Think hammers, clubs etc.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-orange-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-orange-400 transition-colors">Cleave</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Chopping and cutting into your foes, axes and cleavers are a prime example.</span>
                    </div>
                </div>
            </div>
            
            <div>
                <h3 class="text-xl text-indigo-400 font-bold mb-6 uppercase tracking-widest border-b border-slate-800 pb-2">Elemental Damage Types</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                    <div class="rule-card p-5 border-l-4 border-l-orange-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-orange-400 transition-colors">Fire</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Heat, fire, certain explosions. All sources of fire damage can ignite flammable objects.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-blue-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-blue-400 transition-colors">Ice</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Frost is a powerful force. All sources of Ice damage can freeze liquid.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-slate-400 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-slate-300 transition-colors">Lightning</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">The force of the sky, crackling and striking enemies. Electrical devices and magic.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-yellow-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-yellow-400 transition-colors">Light</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Holy energy, often granted by Divine spellcasting.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-black-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-black-400 transition-colors">Dark</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Unholy energy, often granted by Occult spellcasting.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-rose-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-rose-400 transition-colors">Force</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Pure kinetic force. Any impact or push that is not classifiable as any other damage type.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-purple-400 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-purple-300 transition-colors">Psychic</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Damage directly inflicted to the creature's mind.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-lime-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-lime-400 transition-colors">Poison</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">From expired food to snake bites. Often comes bundled with the Poisoned Condition.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-green-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-green-400 transition-colors">Acid</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Melts through many things. Be concerned as it can bypass guard.</span>
                    </div>
                    <div class="rule-card p-5 border-l-4 border-l-teal-500 hover:bg-slate-800/50 transition-colors group">
                        <strong class="text-white block mb-2 text-lg group-hover:text-teal-400 transition-colors">Vibro</strong>
                        <span class="text-xs text-slate-400 leading-relaxed">Thunderous strikes and ringing ears. Short for vibrational damage.</span>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-xl text-indigo-400 font-bold mb-6 uppercase tracking-widest border-b border-slate-800 pb-2">Equipment Tags</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.6)]"></div>
                        <div><strong class="text-indigo-300 block text-sm mb-1 uppercase tracking-wider">Concealable</strong><p class="text-slate-400 text-xs">For roleplay purposes is not considered a weapon or armor.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]"></div>
                        <div><strong class="text-emerald-300 block text-sm mb-1 uppercase tracking-wider">Flexible</strong><p class="text-slate-400 text-xs">Does not impose penalties on stealth or acrobatic movements.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.6)]"></div>
                        <div><strong class="text-orange-300 block text-sm mb-1 uppercase tracking-wider">(Element)proof</strong><p class="text-slate-400 text-xs">You gain resistance to (Element) Damage while wearing it.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-slate-400 shadow-[0_0_8px_rgba(148,163,184,0.6)]"></div>
                        <div><strong class="text-slate-300 block text-sm mb-1 uppercase tracking-wider">Reinforced(P/B/S/C)</strong><p class="text-slate-400 text-xs">Gain resistance to (Puncture/Blunt/Slash/Cleave) Damage.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.6)]"></div>
                        <div><strong class="text-red-300 block text-sm mb-1 uppercase tracking-wider">Restrictive</strong><p class="text-slate-400 text-xs">Imposes disadvantage on Finesse(Stealth) and Reflex.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-indigo-400 shadow-[0_0_8px_rgba(129,140,248,0.6)]"></div>
                        <div><strong class="text-indigo-300 block text-sm mb-1 uppercase tracking-wider">Two-Handed</strong><p class="text-slate-400 text-xs">Requires two hands to wield effectively.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.6)]"></div>
                        <div><strong class="text-cyan-300 block text-sm mb-1 uppercase tracking-wider">Compact</strong><p class="text-slate-400 text-xs">Counts as one weight class lower when stored in inventory.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-yellow-600 shadow-[0_0_8px_rgba(202,138,4,0.6)]"></div>
                        <div><strong class="text-yellow-500 block text-sm mb-1 uppercase tracking-wider">Constructed</strong><p class="text-slate-400 text-xs">Has a durability score; Narrator will inform you.</p></div>
                    </div>
                    <div class="bg-slate-900/30 p-4 rounded-xl border border-slate-700/50 hover:border-indigo-500/30 transition-all hover:bg-slate-900/50 flex items-start gap-3">
                        <div class="mt-1 w-2 h-2 rounded-full bg-purple-500 shadow-[0_0_8px_rgba(168,85,247,0.6)]"></div>
                        <div><strong class="text-purple-300 block text-sm mb-1 uppercase tracking-wider">Powered</strong><p class="text-slate-400 text-xs">Requires fuel to operate.</p></div>
                    </div>
                </div>
            </div>

            <section class="space-y-6">
                <div class="flex items-center gap-4 mb-2">
                    <h2 class="text-2xl text-white font-bold">Armory</h2>
                    <div class="h-px bg-slate-700 flex-1"></div>
                </div>
                
                <details open class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Light Melee</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Reach</th><th>Tags</th><th>Notes</th></tr></thead><tbody id="m1"></tbody></table></div></details>
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Medium Melee</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Reach</th><th>Tags</th><th>Notes</th></tr></thead><tbody id="m2"></tbody></table></div></details>
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Heavy Melee</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Reach</th><th>Tags</th><th>Notes</th></tr></thead><tbody id="m3"></tbody></table></div></details>
                
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Light Ranged</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Range</th><th>Ammo</th><th>Notes</th></tr></thead><tbody id="r1"></tbody></table></div></details>
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Heavy Ranged</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Range</th><th>Ammo</th><th>Notes</th></tr></thead><tbody id="r2"></tbody></table></div></details>
                
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Light Firearms</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Range</th><th>Ammo</th><th>Notes</th></tr></thead><tbody id="f1"></tbody></table></div></details>
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Heavy Firearms</summary><div class="table-wrap mt-4"><table><thead><tr><th>Weapon</th><th>Damage</th><th>Range</th><th>Ammo</th><th>Notes</th></tr></thead><tbody id="f2"></tbody></table></div></details>

                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Armor</summary><div class="table-wrap mt-4"><table><thead><tr><th>Armor</th><th>Rating</th><th>Penalty</th><th>Tags</th><th>Notes</th></tr></thead><tbody id="armor"></tbody></table></div></details>
                <details class="rule-card"><summary class="text-xl text-white font-bold cursor-pointer hover:text-indigo-300">Shields</summary><div class="table-wrap mt-4"><table><thead><tr><th>Shield</th><th>Bonus</th><th>Penalty</th><th>Tags</th><th>Notes</th></tr></thead><tbody id="shields"></tbody></table></div></details>
            </section>
        </div>

        <div id="view-crafting" class="view-section hidden space-y-8">
            <div class="text-center space-y-4 mb-8">
                <h2 class="text-3xl text-white font-bold">Artisan Crafting</h2>
                <p class="text-slate-400">Forge items of power using components found in your travels.</p>
            </div>

            <details open class="rule-card">
                <summary class="text-2xl text-white font-bold cursor-pointer hover:text-indigo-300 flex items-center justify-between group">
                    <span>Recipes</span>
                </summary>

                <div class="flex items-center gap-3 my-6 bg-slate-900/40 p-3 rounded-lg border border-slate-700 w-fit">
                    <label class="text-xs font-bold uppercase tracking-widest text-slate-400">Filter Tier:</label>
                    <select id="tierFilter" onchange="filterCrafting()" class="select-dark text-sm">
                        <option value="all">All Tiers</option>
                        <option>Trivial</option>
                        <option>Simple</option>
                        <option>Standard</option>
                        <option>Difficult</option>
                        <option>Complex</option>
                    </select>
                </div>

                <div class="table-wrap">
                    <table>
                        <thead><tr><th>Name</th><th>Tier</th><th>Category</th><th>Components</th><th>Effect</th></tr></thead>
                        <tbody id="crafting-recipes"></tbody>
                    </table>
                </div>
            </details>

            <details class="rule-card">
                <summary class="text-2xl text-white font-bold cursor-pointer hover:text-indigo-300">Components</summary>
                <div class="table-wrap mt-4">
                    <table>
                        <thead><tr><th>Component</th><th>Category</th><th>Tier</th><th>Notes</th></tr></thead>
                        <tbody id="craft-components"></tbody>
                    </table>
                </div>
            </details>
        </div>

        <div id="view-brewing" class="view-section hidden space-y-8">
            <div class="text-center space-y-4 mb-8">
                <h2 class="text-3xl text-white font-bold">Alchemy & Brewing</h2>
                <p class="text-slate-400">Combine aspects and tiers to produce volatile mixtures.</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <details open class="rule-card h-fit">
                    <summary class="text-2xl text-white font-bold cursor-pointer hover:text-indigo-300">Brewing Rules</summary>
                    <ul class="list-disc list-outside ml-5 text-slate-300 space-y-3 mt-4 text-sm leading-relaxed">
                        <li><strong>Total(A)</strong> = Sum of ingredient aspect values.</li>
                        <li><strong>Tier</strong> = Majority tier of ingredients.</li>
                        <li><strong>DC</strong> = 6 + BITS + DISPARITY + (Tier − 1)</li>
                    </ul>
                </details>

                <div class="rule-card h-fit">
                    <h3 class="text-xl text-white font-bold mb-4">Brewing Calculator</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold uppercase tracking-widest text-slate-400 mb-2">Bitcode Pattern</label>
                            <input id="brewBitcode" type="text" maxlength="5" placeholder="e.g. 10110" class="input-dark font-mono text-lg tracking-widest">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold uppercase tracking-widest text-slate-400 mb-2">Disparity</label>
                                <input id="brewDisparityInput" type="number" min="0" value="0" class="input-dark">
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase tracking-widest text-slate-400 mb-2">Target Tier</label>
                                <select id="brewTier" class="select-dark w-full h-[46px]">
                                    <option value="1">Tier I</option>
                                    <option value="2">Tier II</option>
                                    <option value="3">Tier III</option>
                                    <option value="4">Tier IV</option>
                                </select>
                            </div>
                        </div>
                        <div class="pt-6 mt-4 border-t border-slate-700 flex justify-between items-center">
                            <span class="text-slate-400 text-sm font-bold uppercase tracking-widest">Difficulty Class (DC)</span>
                            <span id="brewDCResult" class="text-4xl text-indigo-400 font-bold fantasy-font">—</span>
                        </div>
                    </div>
                </div>
            </div>

            <details class="rule-card">
                <summary class="text-2xl text-white font-bold cursor-pointer hover:text-indigo-300">Potion Outcomes</summary>
                <div class="table-wrap mt-4">
                    <table>
                        <thead><tr><th>Bitcode</th><th>Name</th><th>Tier I</th><th>Tier II</th><th>Tier III</th><th>Tier IV</th></tr></thead>
                        <tbody id="brew-outcomes"></tbody>
                    </table>
                </div>
            </details>
            
             <details class="rule-card">
                <summary class="text-2xl text-white font-bold cursor-pointer hover:text-indigo-300">Ingredients</summary>
                <div class="table-wrap mt-4">
                    <table><thead><tr><th>Ingredient</th><th>Aspect</th><th>Value</th><th>Tier</th></tr></thead><tbody id="brew-ingredients"></tbody></table>
                </div>
            </details>
        </div>

    </main>
    <div id="footer-placeholder"></div>

    <script>
        // --- Tab Logic ---
        function switchView(viewId) {
            // Hide all sections
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            // Remove active state from buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            
            // Show target
            document.getElementById(viewId).classList.remove('hidden');
            // Set active button
            const index = ['view-equipment', 'view-crafting', 'view-brewing'].indexOf(viewId);
            document.querySelectorAll('.tab-btn')[index].classList.add('active');
        }

        // --- Standard Loading Logic ---
        const formatTags = (tags) => {
            if (!tags || tags === "-") return "-";
            const list = Array.isArray(tags) ? tags : String(tags).split(',').map(t => t.trim());
            return list.map(t => `<span class="tag-badge">${t}</span>`).join('');
        };

        async function loadData() {
            // Layout
            fetch('../css/navbar.html').then(r=>r.text()).then(d=>{
                document.getElementById('navbar-placeholder').innerHTML=d;
                document.querySelectorAll('script').forEach(s=>{
                    const n=document.createElement('script');n.text=s.text;document.body.appendChild(n);
                });
            });
            fetch('../css/footer.html').then(r=>r.text()).then(d=>document.getElementById('footer-placeholder').innerHTML=d);

            // Equipment
            try {
                const res = await fetch('../json/equipment.json');
                const data = await res.json();
                const fill = (id, rows) => {
                    const b = document.getElementById(id); if(!b || !rows) return;
                    b.innerHTML = rows.map(r => `<tr class="row"><td class="font-bold text-white">${r.Name}</td><td><span class="text-emerald-300 font-mono">${r.Damage||r.Rating||r.Bonus||"-"}</span></td><td>${r.Reach||r.Range||"-"}</td><td>${formatTags(r.Ammo||r.Tags||"-")}</td><td class="text-slate-400 text-xs italic">${r.Description||""}</td></tr>`).join("");
                };
                if(data.weapons) { fill("m1", data.weapons.m1); fill("m2", data.weapons.m2); fill("m3", data.weapons.m3); fill("r1", data.weapons.r1); fill("r2", data.weapons.r2); fill("f1", data.weapons.f1); fill("f2", data.weapons.f2); }
                if(data.armor) fill("armor", [...(data.armor.a1||[]), ...(data.armor.a2||[]), ...(data.armor.a3||[])]);
                if(data.shields) fill("shields", data.shields.ss);
            } catch(e) {}

            // Crafting
            try {
                const res = await fetch('../json/crafting.json');
                const data = await res.json();
                document.getElementById("crafting-recipes").innerHTML = (data.recipes||[]).map(r => `<tr class="row" data-tier="${r.tier}"><td class="font-bold text-white">${r.name}</td><td><span class="text-xs bg-slate-800 px-2 py-1 rounded border border-slate-700">${r.tier}</span></td><td>${r.category}</td><td class="text-xs">${(r.components||[]).join(", ")}</td><td class="text-slate-400 italic">${r.effect}</td></tr>`).join("");
                document.getElementById("craft-components").innerHTML = (data.components||[]).map(c => `<tr class="row"><td class="font-bold text-white">${c.name}</td><td>${c.category}</td><td>${c.tier}</td><td class="text-slate-400 italic">${c.notes||""}</td></tr>`).join("");
            } catch(e) {}

            // Brewing
            try {
                const res = await fetch('../json/brewing.json');
                const data = await res.json();
                document.getElementById("brew-outcomes").innerHTML = (data.bitcodes||[]).map(b => `<tr class="row"><td class="font-mono text-indigo-400 font-bold">${b.code}</td><td class="font-bold text-white">${b.name}</td>${(b.effects||[]).map(e=>`<td class="text-slate-400 text-xs">${e}</td>`).join("")}</tr>`).join("");
                document.getElementById("brew-ingredients").innerHTML = (data.ingredients||[]).map(i => `<tr class="row"><td class="font-bold text-white">${i.name}</td><td><span class="tag-badge">${i.aspect}</span></td><td class="font-mono text-emerald-300">${i.value}</td><td>Tier ${i.tier}</td></tr>`).join("");
            } catch(e) {}
        }

        // Brewing Calculator
        document.addEventListener("input", (e) => {
            if(["brewBitcode", "brewDisparityInput", "brewTier"].includes(e.target.id)) {
                const bits = (document.getElementById("brewBitcode").value.match(/1/g)||[]).length;
                const disp = parseInt(document.getElementById("brewDisparityInput").value||0);
                const tier = parseInt(document.getElementById("brewTier").value||1);
                document.getElementById("brewDCResult").textContent = 6 + bits + disp + (tier - 1);
            }
        });
        
        // Crafting Filter
        function filterCrafting() {
            const val = document.getElementById('tierFilter').value;
            document.querySelectorAll('#crafting-recipes tr').forEach(row => {
                row.style.display = (val === 'all' || row.dataset.tier === val) ? 'table-row' : 'none';
            });
        }

        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>